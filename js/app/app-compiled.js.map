{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app-compiled.js","sourcesContent":["/**\n * Created by udaltsov on 25.08.15.\n */\n\"use strict\";\n\nvar userAccount = null;\nvar session = null;\nvar map = {};\nvar config = {};\nvar coreConfig = {};\nvar _carto = {};\nvar forms = {};\nvar utils = {};\nvar model = {};\nvar logic = {};\nvar db = {\n  Document:                         null,\n  DocumentIdentificationObjectRole: null,\n  SurfaceFacility:                  null,\n  Building:                         null,\n  Railroad:                         null,\n  Road:                             null,\n  UndergroundFacility:              null\n};\nvar idb = null;\n\n//временное хранилище\nvar store = {\n  layers:    [],\n  editors:   [],\n  widgets:   [],\n  dicts:     {},\n  stack:     {\n    features: {\n      substation:       {},\n      voltageLevel:     {},\n      structure:        {},\n      acLineSegment:    {},\n      dcLineSegment:    {},\n      busBarSection:    {},\n      powerTransformer: {},\n      switch:           {}\n    }\n  },\n  treeModel: null\n};\n\nfunction getUrlParameters() {\n  var vars = {};\n  window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {\n    vars[key] = value;\n  });\n  return vars;\n}\n\n//функция инициализации\nfunction init() {\n  require([\n    'esri/map',\n    'js/app/http/getUrl.js',\n    './js/app/dataAccess/model-compiled.js',\n    'js/app/domain/carto-compiled.js',\n    'js/app/domain/logic-compiled.js',\n    'js/app/utils/utils-compiled.js',\n    'js/app/forms/forms-compiled.js',\n    'esri/config',\n    'esri/tasks/GeometryService',\n    'dojo/parser',\n    'dojo/domReady!'\n  ], async function (Map,\n                     getUrl,\n                     coreModel,\n                     coreCarto,\n                     coreLogic,\n                     coreUtils,\n                     coreForms,\n                     esriConfig,\n                     GeometryService,\n                     parser) {\n    \n    parser.parse();\n    \n    config = JSON.parse(await getUrl.getUrl(_services.config + \"/configEditor/\" + _currentServer + \"/administrator\"));\n    coreConfig = config;\n    _carto = coreCarto;\n    forms = coreForms;\n    model = coreModel;\n    utils = coreUtils;\n    logic = coreLogic;\n    \n    esriConfig.defaults.io.proxyUrl = config.proxyUrl;\n    esriConfig.defaults.geometryService = new GeometryService(config.geometryServiceUrl);\n    \n    function initMap() {\n      return new Promise(function (resolve) {\n        map = new Map(\"mapDiv\", {\n          basemap:              \"osm\",\n          center:               [40.229, 47.399911],\n          zoom:                 18,\n          nav:                  true,\n          slider:               true,\n          sliderPosition:       \"top-right\",\n          autoResize:           true,\n          showAttribution:      false,\n          showLabels:           true,\n          displayGraphicsOnPan: false,\n          fadeOnZoom:           true,\n          force3DTransforms:    true,\n          logo:                 false,\n          navigationMode:       \"css-transforms\",\n          opacity:              0.3\n        });\n        \n        resolve(\"success\");\n      });\n    }\n    \n    utils.initPouchDB()\n      .then(function () {\n        return idb.get(\"map_settings\")\n      })\n      .then(function (doc) {\n        return initMap(doc);\n      })\n      .catch(function () {\n        return initMap();\n      })\n      .then(function () {\n        return utils.loadDictionaries();\n      })\n      .then(function () {\n        return utils.initLoginWindow()\n      })\n      .then(function (currentSession) {\n        utils.loadEditorHandlers(currentSession);\n        \n        coreUtils.loadVectorLayers(currentSession);\n        coreUtils.loadEditorLayers(currentSession);\n        coreUtils.loadControls(currentSession);\n        \n        map.on(\"layers-add-result\", function (evt) {\n          coreUtils.initEditor(evt, currentSession);\n          coreUtils.initTableFeatureLayer();\n          coreUtils.initList(currentSession);\n        });\n      })\n  });\n}\n\n//отчет по ЦП\nfunction substationEnergyCenterReport() {\n  require([\n    \"../../../../Application/\" + _currentServer + \"/config/config-compiled.js\",\n    \"./js/app/dataAccess/model-compiled.js\",\n    \"js/app/domain/logic-compiled.js\",\n    \"js/app/utils/utils-compiled.js\",\n    \"js/app/forms/forms-compiled.js\",\n    \"dojo/parser\",\n    \"dojo/domReady!\"\n  ], function (coreConfig,\n               coreModel,\n               coreLogic,\n               coreUtils,\n               coreForms,\n               parser) {\n    \n    parser.parse();\n    \n    config = coreConfig;\n    forms = coreForms;\n    model = coreModel;\n    utils = coreUtils;\n    logic = coreLogic;\n    \n    utils.loadDB();\n    logic.getSubstationEnergyCenterReport(getUrlParameters()[\"id\"]);\n  });\n}\n\nfunction initSearch() {\n  return new Promise(function (resolve) {\n    require([\n      \"../../../../Application/\" + _currentServer + \"/config/config-compiled.js\",\n      \"./js/app/dataAccess/model-compiled.js\",\n      \"js/app/domain/logic-compiled.js\",\n      \"js/app/utils/utils-compiled.js\",\n      \"js/app/forms/forms-compiled.js\",\n      \"dojo/parser\",\n      \"dojo/domReady!\"\n    ], function (coreConfig,\n                 coreModel,\n                 coreLogic,\n                 coreUtils,\n                 coreForms,\n                 parser) {\n      \n      parser.parse();\n      \n      config = coreConfig;\n      forms = coreForms;\n      model = coreModel;\n      utils = coreUtils;\n      logic = coreLogic;\n      \n      utils.loadDB();\n      resolve({status: \"success\"});\n    });\n  })\n  \n}\n\nfunction _getConf(id) {\n  for (var i = 0; i < config.editors.length; i++) {\n    if (config.editors[i].id == id) return config.editors[i];\n  }\n}\n\nfunction _getStore(id) {\n  for (var i = 0; i < config.editors.length; i++) {\n    if (config.editors[i].id == id) {\n      return store.editors[i];\n    }\n  }\n}\n\nfunction _getEditorLayer(id) {\n  for (var i = 0; i < store.editors.length; i++) {\n    if (store.editors[i].id == id) {\n      return store.editors[i];\n    }\n  }\n}\n\nfunction _updateLayerByFeature(id, feature, fieldName) {\n  var layer = _getEditorLayer(id);\n  var graphics = layer.graphics;\n  var graphic = null;\n  for (var i = 0; i < graphics.length; i++) {\n    if (graphics[i].attributes[fieldName] == feature.attributes[fieldName]) {\n      graphic = graphics[i];\n      graphic.setGeometry(feature.geometry);\n      graphic.setAttributes(feature.attributes);\n      break;\n    }\n  }\n}\n\nfunction getFieldTranslation(fieldName) {\n  if (config.translation[fieldName] !== undefined) return config.translation[fieldName].alias;\n  return fieldName;\n}\n\nfunction featuresToArray(data, field) {\n  var features = data.features;\n  var result = [];\n  for (var i = 0; i < features.length; i++) {\n    if (field !== undefined) {\n      result.push(features[i].attributes[field]);\n    } else {\n      var attributes = features[i].attributes;\n      var geometryProps = _carto.getGeometryProps(features[i].geometry);\n      if (geometryProps != null) {\n        try {\n          attributes[\"lat\"] = geometryProps[\"lat\"];\n          attributes[\"lon\"] = geometryProps[\"lon\"];\n        }\n        catch (e) {\n          attributes[\"lat\"] = '-';\n          attributes[\"lon\"] = '-';\n        }\n        \n      }\n      result.push(attributes);\n    }\n  }\n  return result;\n}\n\nfunction featuresPropertyToArray(data, fieldName) {\n  var result = [];\n  for (var i = 0; i < data.length; i++) {\n    result.push(data[i].attributes[fieldName]);\n  }\n  return result;\n}\n\nfunction bindClick(elementName, func) {\n  var $element = $(\"#\" + elementName);\n  $element.off(\"click\", null);\n  $element.click(func);\n}\n\nfunction linkClick(elementName, func) {\n  var $element = $(\"a[href='#\" + elementName + \"']\");\n  $element.off(\"click\", null);\n  $element.click(func);\n}\n\n/**\n * Сохранение объекта в файл\n * @param filename\n * @param text\n */\nfunction download(filename, text) {\n  var element = document.createElement('a');\n  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\n  element.setAttribute('download', filename);\n  \n  element.style.display = 'none';\n  document.body.appendChild(element);\n  \n  element.click();\n  \n  document.body.removeChild(element);\n}\n\n//todo \nfunction distinct(objectArray) {\n  \n  var distinctResult = [];\n  \n  $.each(objectArray, function (i, currentObject) {\n    if (!exists(distinctResult, currentObject))\n      distinctResult.push(currentObject);\n  });\n  \n  return distinctResult;\n}\n\nfunction exists(arr, object) {\n  var compareToJson = JSON.stringify(object),\n    result = false;\n  $.each(arr, function (i, existingObject) {\n    if (JSON.stringify(existingObject) === compareToJson) {\n      result = true;\n      return false; // break\n    }\n  });\n  \n  return result;\n}\n\n\n\n\n"]}