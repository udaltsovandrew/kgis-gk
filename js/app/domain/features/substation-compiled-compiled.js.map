{"version":3,"sources":["substation-compiled.js"],"names":[],"mappings":"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","file":"substation-compiled-compiled.js","sourcesContent":["/**\n * Created by udaltsov on 30.10.15.\n */\n\"use strict\";\n\ndefine([\"./js/app/dataAccess/model-compiled.js\", \"./js/app/domain/generators-compiled.js\"], function (model, generators) {\n\n  var context = new model({ url: \"\", className: \"\", map: map });\n\n  var proto = {\n    base: {\n      className: \"Substation\"\n    },\n    chields: [{\n      className: \"VoltageLevel\"\n    }, {\n      className: \"PowerTransformer\"\n    }, {\n      className: \"ErpAddress\"\n    }]\n  };\n\n  function create(point) {\n    var feature = generators.Substation.default;\n    feature.geometry = point;\n    return db.Substation.add(feature).then(function (data) {\n      var id = data[0][0].objectId;\n      return db.Substation.getById(id);\n    });\n  }\n\n  function createDefaultEquipment(id) {\n    var feature = null;\n    var parentId = id;\n    var voltageLevel10 = null;\n    var voltageLevel04 = null;\n    var container10 = null;\n    var container04 = null;\n    return read(id).then(function (data) {\n      feature = context.first(data);\n      voltageLevel10 = generators.VoltageLevel.U10;\n      voltageLevel10.geometry = feature.geometry;\n      return db.VoltageLevel.add(voltageLevel10);\n    }).then(function (data) {\n      return db.VoltageLevel.getById(data[0][0].objectId);\n    }).then(function (data) {\n      voltageLevel10 = context.first(data);\n      voltageLevel04 = generators.VoltageLevel.U04;\n      voltageLevel04.geometry = feature.geometry;\n      return db.VoltageLevel.add(voltageLevel04);\n    }).then(function (data) {\n      return db.VoltageLevel.getById(data[0][0].objectId);\n    }).then(function (data) {\n      voltageLevel04 = context.first(data);\n      container10 = context.containerTemplate(parentId, voltageLevel10.attributes[\"OBJECTID\"], \"Substation\", \"VoltageLevel\", feature.geometry);\n      return db.EquipmentContainer.add(container10);\n    }).then(function () {\n      container04 = context.containerTemplate(parentId, voltageLevel04.attributes[\"OBJECTID\"], \"Substation\", \"VoltageLevel\", feature.geometry);\n      return db.EquipmentContainer.add(container04);\n    }).then(function () {\n      return db.Substation.getById(parentId);\n    });\n  }\n\n  function read(id) {\n    return db.Substation.getById(id);\n  }\n\n  function update(data) {}\n\n  function del(id) {\n    return db.Substation.delById(id);\n  }\n\n  function deleteChields(id) {\n    var parentMRID = id;\n    var voltageLevelIds = [];\n    var powerTransformerIds = [];\n    var equipmentContainerIds = [];\n    db.EquipmentContainer.get({ where: \"parentClassName='Substation' AND parentMRID = \" + parentMRID }).then(function (data) {\n      equipmentContainerIds = featuresPropertyToArray(context.all(data), \"OBJECTID\");\n      voltageLevelIds = context.allByFilter(data, \"chieldClassName\", \"VoltageLevel\");\n      powerTransformerIds = context.allByFilter(data, \"chieldClassName\", \"PowerTransformer\");\n      voltageLevelIds = featuresPropertyToArray(voltageLevelIds, \"chieldMRID\");\n      powerTransformerIds = featuresPropertyToArray(powerTransformerIds, \"chieldMRID\");\n      return db.VoltageLevel.delByArray(voltageLevelIds);\n    }).then(function () {\n      return db.PowerTransformer.delByArray(powerTransformerIds);\n    }).then(function () {\n      return db.EquipmentContainer.delByArray(equipmentContainerIds);\n    });\n  }\n\n  return {\n    proto: proto,\n    create: create,\n    createDefaultEquipment: createDefaultEquipment,\n    read: read,\n    update: update,\n    del: del,\n    deleteChields: deleteChields\n  };\n});\n\n//# sourceMappingURL=substation-compiled.js.map"]}