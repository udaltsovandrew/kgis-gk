{"version":3,"sources":["powerTransformer.js"],"names":[],"mappings":";;;AAGA;;AAEA,OAAO,CACH,uCADG,EAEH,wCAFG,CAAP,EAIE,UAAU,KAAV,EACU,UADV,EACsB;;AAEpB,MAAI,UAAU,IAAI,KAAJ,CAAU,EAAC,KAAK,EAAL,EAAS,WAAW,EAAX,EAAe,KAAK,GAAL,EAAnC,CAAV,CAFgB;;AAIpB,MAAI,QAAQ;AACV,UAAM;AACJ,iBAAW,kBAAX;KADF;AAGA,YAAQ;AACN,iBAAW,YAAX;KADF;GAJE,CAJgB;;AAapB,WAAS,MAAT,CAAgB,QAAhB,EAA0B;AACxB,QAAI,aAAa,EAAb,CADoB;AAExB,QAAI,qBAAqB,IAArB,CAFoB;AAGxB,WAAO,GAAG,UAAH,CAAc,OAAd,CAAsB,QAAtB,EACJ,IADI,CACC,UAAU,IAAV,EAAgB;AACpB,mBAAa,QAAQ,KAAR,CAAc,IAAd,CAAb,CADoB;AAEpB,UAAI,UAAU,WAAW,gBAAX,CAA4B,OAA5B,CAFM;AAGpB,cAAQ,QAAR,GAAmB,WAAW,QAAX,CAHC;AAIpB,aAAO,GAAG,gBAAH,CAAoB,GAApB,CAAwB,OAAxB,CAAP,CAJoB;KAAhB,CADD,CAOJ,IAPI,CAOC,UAAU,IAAV,EAAgB;AACpB,2BAAqB,QAAQ,OAAR,CAAgB,IAAhB,EAAsB,CAAtB,EAAyB,QAAzB,CADD;AAEpB,UAAI,YAAY,QAAQ,iBAAR,CAA0B,QAA1B,EAAoC,kBAApC,EAAwD,YAAxD,EAAsE,kBAAtE,EAA0F,WAAW,QAAX,CAAtG,CAFgB;AAGpB,aAAO,GAAG,kBAAH,CAAsB,GAAtB,CAA0B,SAA1B,CAAP,CAHoB;KAAhB,CAPD,CAYJ,IAZI,CAYC,YAAY;AAChB,aAAO,GAAG,gBAAH,CAAoB,OAApB,CAA4B,kBAA5B,CAAP,CADgB;KAAZ,CAZR,CAHwB;GAA1B;;AAoBA,WAAS,IAAT,CAAc,EAAd,EAAkB;AAChB,WAAO,GAAG,gBAAH,CAAoB,OAApB,CAA4B,EAA5B,CAAP,CADgB;GAAlB;;AAIA,WAAS,MAAT,CAAgB,IAAhB,EAAsB,EAAtB;;AAIA,WAAS,GAAT,CAAa,EAAb,EAAiB;AACf,WAAO,GAAG,kBAAH,CACJ,GADI,CACA,EAAC,OAAO,QAAQ,cAAR,CAAuB,YAAvB,EAAqC,kBAArC,EAAyD,IAAzD,EAA+D,EAA/D,CAAP,EADD,EAEJ,IAFI,CAEC,UAAU,IAAV,EAAgB;AACpB,aAAO,GAAG,kBAAH,CAAsB,OAAtB,CAA8B,QAAQ,GAAR,CAAY,QAAQ,KAAR,CAAc,IAAd,CAAZ,CAA9B,CAAP,CADoB;KAAhB,CAFD,CAKJ,IALI,CAKC,YAAY;AAChB,aAAO,GAAG,gBAAH,CAAoB,OAApB,CAA4B,EAA5B,CAAP,CADgB;KAAZ,CALR,CADe;GAAjB;;AAWA,SAAO;AACL,WAAO,KAAP;AACA,YAAQ,MAAR;AACA,UAAM,IAAN;AACA,YAAQ,MAAR;AACA,SAAK,GAAL;GALF,CApDoB;CADtB,CAJF","file":"powerTransformer-compiled.js","sourcesContent":["/**\r\n * Created by udaltsov on 30.10.15.\r\n */\r\n\"use strict\";\r\n\r\ndefine([\r\n    \"./js/app/dataAccess/model-compiled.js\",\r\n    \"./js/app/domain/generators-compiled.js\"\r\n  ],\r\n  function (model,\r\n            generators) {\r\n\r\n    var context = new model({url: \"\", className: \"\", map: map});\r\n\r\n    var proto = {\r\n      base: {\r\n        className: \"PowerTransformer\"\r\n      },\r\n      parent: {\r\n        className: \"Substation\"\r\n      },\r\n    };\r\n\r\n    function create(parentId) {\r\n      var substation = {};\r\n      var powerTransformerId = null;\r\n      return db.Substation.getById(parentId)\r\n        .then(function (data) {\r\n          substation = context.first(data);\r\n          var feature = generators.PowerTransformer.default;\r\n          feature.geometry = substation.geometry;\r\n          return db.PowerTransformer.add(feature);\r\n        })\r\n        .then(function (data) {\r\n          powerTransformerId = context.getAdds(data)[0].objectId;\r\n          var container = context.containerTemplate(parentId, powerTransformerId, \"Substation\", \"PowerTransformer\", substation.geometry);\r\n          return db.EquipmentContainer.add(container);\r\n        })\r\n        .then(function () {\r\n          return db.PowerTransformer.getById(powerTransformerId)\r\n        })\r\n    }\r\n\r\n    function read(id) {\r\n      return db.PowerTransformer.getById(id);\r\n    }\r\n\r\n    function update(data) {\r\n\r\n    }\r\n\r\n    function del(id) {\r\n      return db.EquipmentContainer\r\n        .get({where: context.containerWhere(\"Substation\", \"PowerTransformer\", null, id)})\r\n        .then(function (data) {\r\n          return db.EquipmentContainer.delById(context.key(context.first(data)))\r\n        })\r\n        .then(function () {\r\n          return db.PowerTransformer.delById(id)\r\n        })\r\n    }\r\n\r\n    return {\r\n      proto: proto,\r\n      create: create,\r\n      read: read,\r\n      update: update,\r\n      del: del\r\n    }\r\n  });"]}