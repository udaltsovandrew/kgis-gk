{"version":3,"sources":["logic.js"],"names":[],"mappings":"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","file":"logic-compiled.js","sourcesContent":["\"use strict\";\n\ndefine([\n  \"./js/app/forms/forms-compiled.js\",\n  \"./js/app/dataAccess/model-compiled.js\",\n  \"./js/app/domain/http-compiled.js\",\n  \"./js/app/domain/dxf.js\",\n  \"./js/app/domain/features/substation-compiled.js\",\n  \"./js/app/domain/features/powerLine-compiled.js\",\n  \"./js/app/domain/features/acLineSegment-compiled.js\",\n  \"./js/app/domain/features/voltageLevel-compiled.js\",\n  \"./js/app/domain/features/powerTransformer-compiled.js\",\n  \"./js/app/domain/features/account-compiled.js\",\n  \"./js/app/domain/interactiveMap/index.js\",\n  \"./js/app/domain/generators-compiled.js\",\n  \"./js/app/domain/carto-compiled.js\",\n  \"./js/app/domain/misc/sac-compiled.js\",\n  \"./js/app/domain/misc/projects-compiled.js\",\n  \"./js/app/domain/misc/geometryView-compiled.js\",\n  \"./js/app/domain/misc/export-compiled.js\",\n  \"./js/app/domain/features/crew-compiled.js\"\n], function (forms,\n             model,\n             httpUtils,\n             dxfUtils,\n             substation,\n             temporaryPowerLine,\n             acLineSegment,\n             voltageLevel,\n             powerTransformer,\n             account,\n             interactiveMap,\n             generators,\n             carto,\n             sac,\n             projects,\n             geometryView,\n             exportUtils,\n             crewUtils) {\n  \n  var context = new model({url: \"\", className: \"context\", map: map});\n  \n  function getClickHandler(id) {\n    var alias = id;\n    if (alias.indexOf(\"Substation\") != -1) alias = \"Substation\";\n    if (alias.indexOf(\"Structure\") != -1) alias = \"Structure\";\n    \n    var handlers = {\n      SurfaceFacility:     function (data) {\n        var id=context.key(data.graphic);\n        forms.open(\"SurfaceFacility\", data.graphic);\n        loadClassNameDocumentList(id, \"SurfaceFacility\");\n      },\n      Building:            function (data) {\n        var id=context.key(data.graphic);\n        forms.open(\"Building\", data.graphic);\n        loadClassNameDocumentList(id, \"Building\");\n      },\n      Railroad:            function (data) {\n        var id=context.key(data.graphic);\n        forms.open(\"Railroad\", data.graphic);\n        loadClassNameDocumentList(id, \"Road\");\n      },\n      Road:                function (data) {\n        var id=context.key(data.graphic);\n        forms.open(\"Road\", data.graphic);\n        loadClassNameDocumentList(id, \"Road\");\n      },\n      UndergroundFacility: function (data) {\n        var id=context.key(data.graphic);\n        forms.open(\"UndergroundFacility\", data.graphic);\n        loadClassNameDocumentList(id, \"UndergroundFacility\");\n      },\n    };\n    return handlers[alias];\n  }\n  \n  function getEditorHandler(id) {\n    var handlers = {\n    };\n    return handlers[id];\n  }\n  \n  async function getChields(parentMRID, parentClassName, chieldClassName, proxyClassName) {\n    var where = \"parentClassName = '\" + parentClassName + \"' AND chieldClassName='\" + chieldClassName + \"' AND parentMRID=\" + parentMRID;\n    var data = await db[proxyClassName].get({where: where});\n    var features = context.all(data);\n    var ids = features.map(function (item) {\n      return item.attributes.chieldMRID\n    });\n    data = await (db[chieldClassName].getByArray(ids));\n    features = context.all(data);\n    return features;\n  }\n  \n  function initFeatureTable(className) {\n    var tableName = className + \"-List\";\n    db[className]\n      .get({where: \"1=1\"})\n      .then(function (data) {\n        forms.createTable(tableName, context.all(data), className);\n      })\n  }\n  \n  async function initFeatureList(className, elementName) {\n    var tableName = elementName;\n    var data = await (db[className].get({where: \"1=1\"}));\n    forms.createTable(tableName, context.all(data), className);\n  }\n  \n  function loadPowerLineList() {\n    var tableName = \"PowerLine-List\";\n    bindClick(\"addPowerLine\", function () {\n      addPowerLine(tableName);\n    });\n    bindClick(\"editPowerLine\", function () {\n      editPowerLine(forms.getObjectID(tableName));\n    });\n    bindClick(\"deletePowerLine\", function () {\n      deletePowerLine(forms.getObjectID(tableName), tableName);\n    });\n    initFeatureTable(\"PowerLine\");\n  }\n  \n  function loadSubstationList() {\n    var tableName = \"Substation-List\";\n    bindClick(\"addSubstation\", function () {\n      addSubstation(tableName);\n    });\n    bindClick(\"editSubstation\", function () {\n      editSubstation(forms.getObjectID(tableName));\n    });\n    bindClick(\"deleteSubstation\", function () {\n      deleteSubstation(forms.getObjectID(tableName), tableName);\n    });\n    initFeatureTable(\"Substation\");\n  }\n  \n  function initCustomerErpPersonTabs(data) {\n    var id = context.key(data);\n    loadCustomerVoltageLevelList(id, \"CustomerErpPerson\");\n    loadCustomerPowerCircuitList(id, \"CustomerErpPerson\");\n  }\n  \n  function initCustomerOrganisationTabs(data) {\n    var id = context.key(data);\n    loadCustomerVoltageLevelList(id, \"CustomerOrganisation\");\n    loadCustomerPowerCircuitList(id, \"CustomerOrganisation\");\n  }\n  \n  async function loadCustomerVoltageLevelList(id, className) {\n    var tableName = className + \"-VoltageLevel-List\";\n    bindClick(\"add\" + className + \"VoltageLevel\", async function () {\n      var data = await (db[className].getById(id));\n      data = context.first(data);\n      var voltageLevel = generators.VoltageLevel.U04CustomerErpPerson;\n      voltageLevel.geometry = data.geometry;\n      data = await (db.VoltageLevel.add(voltageLevel));\n      var chieldMRID = data[0][0].objectId;\n      voltageLevel = await (db.VoltageLevel.getById(chieldMRID));\n      voltageLevel = context.first(voltageLevel);\n      var container = context.containerTemplate(id, chieldMRID, className, \"VoltageLevel\", voltageLevel.geometry);\n      data = await (db.EquipmentContainer.add(container));\n      if (data) forms.appendRowInTable(tableName, voltageLevel.attributes);\n    });\n    bindClick(\"edit\" + className + \"VoltageLevel\", async function () {\n      var objectId = forms.getObjectID(tableName);\n      var feature = await (db.VoltageLevel.getById(objectId));\n      feature = context.first(feature);\n      forms.open(\"VoltageLevel\", feature);\n    });\n    bindClick(\"delete\" + className + \"VoltageLevel\", async function () {\n      var ids = forms.getObjectIDS(tableName);\n      ids = \"chieldMRID=\" + ids.join(\" OR chieldMRID=\");\n      var where = \"parentClassName='\" + className + \"' AND chieldClassName='VoltageLevel' AND parentMRID=\" + id + \" AND (\" + ids + \")\";\n      var data = await (db.EquipmentContainer.get({where: where}));\n      ids = data.features.map(function (item) {\n        return item.attributes.OBJECTID\n      });\n      data = await (db.EquipmentContainer.delByArray(ids));\n      if (data) forms.removeSelectedRows(tableName);\n    });\n    \n    var data = await (db.EquipmentContainer.get({where: \"parentClassName='\" + className + \"' AND chieldClassName='VoltageLevel' AND parentMRID=\" + id}));\n    var ids = data.features.map(function (item) {\n      return item.attributes.chieldMRID;\n    });\n    data = await (db.VoltageLevel.getByArray(ids));\n    forms.createTable(tableName, context.all(data), \"VoltageLevel\");\n  }\n  \n  async function loadCustomerPowerCircuitList(id, className) {\n    var table = className + \"-PowerCircuit-List\";\n    bindClick(\"add\" + className + \"PowerCircuit\", async function () {\n      var data = await (db[className].getById(id));\n      var feature = context.first(data);\n      \n      var _powerCircuit = {\n        attributes: {\n          parentMRID:      id,\n          parentClassName: className,\n          chieldClassName: \"PowerCircuit\"\n        },\n        geometry:   feature.geometry\n      };\n      var action = await (db.PsrList.add(_powerCircuit));\n      var _powerCircuitId = action[0][0].objectId;\n      action = await (db.PsrList.getById(_powerCircuitId));\n      _powerCircuit = context.first(action);\n      forms.appendRowInTable(table, _powerCircuit.attributes);\n    });\n    bindClick(\"edit\" + className + \"PowerCircuit\", async function () {\n      var objectId = forms.getObjectID(table);\n      var action = await (db.PsrList.getById(objectId));\n      var feature = context.first(action);\n      forms.open(\"PsrList\", feature);\n      loadPsrListClassNameList(objectId, \"Substation\");\n      loadPsrListClassNameList(objectId, \"PowerLine\");\n      loadPsrListClassNameList(objectId, \"EnergySource\");\n    });\n    bindClick(\"delete\" + className + \"PowerCircuit\", async function () {\n      var ids = forms.getObjectIDS(table);\n      forms.removeSelectedRows(table);\n      for (var i = 0; i < ids.length; i++) {\n        db.PsrList.delById(ids[i]);\n      }\n    });\n    \n    var where = \"parentMRID=\" + id + \" AND parentClassName='\" + className + \"' AND chieldClassName='PowerCircuit'\";\n    var data = await (db.PsrList.get({where: where}));\n    var features = context.all(data);\n    forms.createTable(table, features, \"PsrList\");\n  }\n  \n  async function loadPsrListClassNameList(id, className) {\n    var table = \"PsrList-\" + className + \"-List\";\n    var tableCandidate = \"PsrList-\" + className + \"-Candidate-List\";\n    bindClick(\"linkPsrList\" + className, async function () {\n      var ids = forms.getObjectIDS(tableCandidate);\n      var containers = ids.map(function (chieldId) {\n        return {\n          attributes: {\n            parentMRID:      id,\n            parentClassName: \"PsrList\",\n            chieldClassName: className,\n            chieldMRID:      chieldId\n          }\n        }\n      });\n      var action = await (db.PsrIdObjectRole.addArray(containers));\n      if (action) {\n        var data = await (db[className].getByArray(ids));\n        features = context.all(data);\n        loadPsrListClassNameList(id, className);\n      }\n    });\n    bindClick(\"relinkPsrList\" + className, async function () {\n      var ids = forms.getObjectIDS(table);\n      var chieldIds = \"chieldMRID=\" + ids.join(\" OR chieldMRID=\");\n      var where = \"parentMRID=\" + id + \" AND parentClassName='PsrList' AND chieldClassName='\" + className + \"' AND (\" + chieldIds + \")\";\n      var containers = await (db.PsrIdObjectRole.get({where: where}));\n      containers = context.all(containers);\n      ids = containers.map(function (item) {\n        return item.attributes.OBJECTID\n      });\n      for (var i = 0; i < ids.length; i++) {\n        await(db.PsrIdObjectRole.delById(ids[i]));\n      }\n      forms.removeSelectedRows(table);\n    });\n    \n    bindClick(\"refreshPsrList\" + className, async function () {\n      var editor = _getEditorLayer(className);\n      //noinspection JSUnresolvedFunction\n      var candidates = editor.getSelectedFeatures();\n      forms.createTable(tableCandidate, candidates, className);\n    });\n    \n    var features = await (getChields(id, \"PsrList\", className, \"PsrIdObjectRole\"));\n    forms.createTable(table, features, className);\n    \n    var editor = _getEditorLayer(className);\n    //noinspection JSUnresolvedFunction\n    var candidates = editor.getSelectedFeatures();\n    forms.createTable(tableCandidate, candidates, className);\n  }\n  \n  async function initStructureTabs(data) {\n    var id = context.key(data);\n    loadStructureACLineSegments(id);\n    linkClick(\"Structure-Geometry\", function () {\n      geometryView.loadGeometryProperty(data, \"Structure-Geometry\");\n    });\n  }\n  \n  async function loadStructureACLineSegments(id) {\n    var tableName = \"Structure-Connection-List\";\n    \n    bindClick(\"editStructureACLineSegment\", async function () {\n      var acLineSegmentId = forms.getObjectID(tableName);\n      var data = await (db.ACLineSegment.getById(acLineSegmentId));\n      forms.open(\"ACLineSegment\", context.first(data));\n    });\n    \n    bindClick(\"deleteStructureConnection\", async function () {\n      var ids = forms.getObjectIDS(tableName);\n      ids = \"parentMRID=\" + ids.join(\" OR parentMRID=\");\n      var where = \"parentClassName='ACLineSegment' AND chieldClassName='Structure' AND chieldMRID=\" + id + \" AND (\" + ids + \")\";\n      var data = await (db.EquipmentContainer.get({where: where}));\n      ids = data.features.map(function (item) {\n        return item.attributes.OBJECTID\n      });\n      var action = await (db.EquipmentContainer.delByArray(ids));\n      if (action) forms.removeSelectedRows(tableName);\n    });\n    \n    var containers = await (db.EquipmentContainer.get({where: context.containerWhere(\"ACLineSegment\", \"Structure\", null, id)}));\n    containers = context.all(containers);\n    var ids = containers.map(function (item) {\n      return item.attributes.parentMRID\n    });\n    var acLineSegments = await (db.ACLineSegment.getByArray(ids));\n    acLineSegments = context.all(acLineSegments);\n    forms.createTable(tableName, acLineSegments, \"ACLineSegment\");\n  }\n  \n  //Мероприятие САЦ\n  function initSACEventListTabs(data) {\n    loadSACEventListErpPersonList(context.key(data));\n    loadClassNameDocumentList(context.key(data), \"SACEventList\");\n  }\n  \n  // Список ответственных лиц, связанных с объектом мероприятия\n  async function loadSACEventListErpPersonList(id) {\n    var tableNameDestination = \"SACEventList-ErpPerson-List\";\n    var tableNameSource = \"SACEventList-ErpPerson-Source-List\";\n    forms.createTable(tableNameDestination, [], \"ErpPerson\");\n    forms.createTable(tableNameSource, [], \"ErpPerson\");\n    \n    db.ErpPerson.get({where: \"1=1\"})\n      .then(function (data) {\n        forms.loadTableData(tableNameSource, featuresToArray(data));\n      });\n    \n    db.ErpPersonIdentificationObjectRole\n      .get({where: \"parentClassName='SACEventList' AND chieldClassName='ErpPerson' AND parentMRID=\" + id})\n      .then(function (data) {\n        var ids = featuresToArray(data, \"chieldMRID\");\n        return db.ErpPerson.getByArray(ids)\n      })\n      .then(function (data) {\n        forms.loadTableData(tableNameDestination, featuresToArray(data));\n      });\n    \n    bindClick(\"linkSACEventListErpPerson\", function () {\n      var ids = forms.getTableRows(tableNameSource).map(function (item) {\n        return item.OBJECTID\n      });\n      var persons = null;\n      return db.ErpPerson\n        .getByArray(ids)\n        .then(function (data) {\n          persons = context.all(data);\n          var containers = persons.map(function (item) {\n            var attributes = item.attributes;\n            attributes.parentMRID = id;\n            attributes.parentClassName = \"SACEventList\";\n            attributes.chieldClassName = \"ErpPerson\";\n            attributes.chieldMRID = attributes.OBJECTID;\n            return {\n              geometry:   item.geometry,\n              attributes: attributes\n            }\n          });\n          return db.ErpPersonIdentificationObjectRole.addArray(containers)\n        })\n        .then(function () {\n          for (var i = 0; i < persons.length; i++) {\n            forms.appendRowInTable(tableNameDestination, persons[i].attributes);\n          }\n        })\n    });\n    bindClick(\"relinkSACEventListErpPerson\", function () {\n      var ids = forms.getTableRows(tableNameDestination).map(function (item) {\n        return item.OBJECTID\n      });\n      forms.removeSelectedRows(tableNameDestination);\n      for (var i = 0; i < ids.length; i++) {\n        db.ErpPersonIdentificationObjectRole\n          .get({where: \"parentClassName='SACEventList' AND chieldClassName='ErpPerson' AND parentMRID=\" + id + \" AND chieldMRID=\" + ids[i]})\n          .then(function (data) {\n            var featureId = context.key(context.first(data));\n            db.ErpPersonIdentificationObjectRole.delById(featureId);\n          })\n      }\n    });\n    bindClick(\"addErpPersonFromSACEventList\", function () {\n      db.ErpPerson.add(generators.ErpPerson.default)\n        .then(function (data) {\n          return db.ErpPerson.getById(data[0][0].objectId)\n        })\n        .then(function (data) {\n          forms.open(\"ErpPerson\", context.first(data));\n          forms.appendRowInTable(tableNameSource, context.first(data)[\"attributes\"]);\n        })\n    });\n    bindClick(\"editErpPersonFromSACEventList\", function () {\n      var featureId = forms.getTableSelection(tableNameSource)[\"OBJECTID\"];\n      db.ErpPerson.getById(featureId)\n        .then(function (data) {\n          forms.open(\"ErpPerson\", context.first(data));\n        })\n    });\n    bindClick(\"deleteErpPersonFromSACEventList\", function () {\n      var featureId = forms.getTableSelection(tableNameSource)[\"OBJECTID\"];\n      db.ErpPerson.delById(featureId).then(function () {\n        forms.deleteRowInTable(tableNameSource, featureId);\n      });\n    })\n  }\n  \n  //Функции САЦ - вынести в отдельный класс\n  function initSACEventTabs(data) {\n    loadSACEventListChieldClassNameList(context.key(data), \"CustomerOrganisation\", \"площадка мероприятия\");\n    loadSACEventListChieldClassNameList(context.key(data), \"CustomerErpPerson\", \"площадка мероприятия\");\n    loadSACEventListChieldClassNameList(context.key(data), \"EnergySource\", \"РИСЭ\");\n    loadSACEventListChieldClassNameList(context.key(data), \"Crew\", \"бригада\");\n    loadSACEventListChieldClassNameList(context.key(data), \"StorageFacility\", \"склад аварийного резерва\");\n    loadSACEventListChieldClassNameList(context.key(data), \"GuardCrew\", \"патрульная группа\");\n    loadSACEventListChieldClassNameList(context.key(data), \"GuardFacility\", \"пост охраны\");\n    loadSACEventListChieldClassNameList(context.key(data), \"Organisation\", \"подрядная организация\");\n    loadSACEventListChieldClassNameList(context.key(data), \"Vehicle\", \"автотранспорт\");\n    loadSACEventListChieldClassNameList(context.key(data), \"Substation\", \"площадка мероприятия\");\n    loadClassNameDocumentList(context.key(data), \"SACEvent\");\n  }\n  \n  function loadClassNameDocumentList(id, className) {\n    var tableName = className + \"-\" + \"Document\" + \"-List\";\n    forms.createTable(tableName, [], \"Document\");\n    \n    initAddFile(className, id);\n    \n    function initAddFile(_className, _id) {\n      var feature;\n      var document;\n      forms.getUpload(\"add\" + _className + \"Document\", config.documents.saveUrl + \"?className=\" + _className + \"&id=\" + _id)\n        .then(function (data) {\n          var filesData = data;\n          initAddFile(_className, _id);\n          return db[className]\n            .getById(_id)\n            .then(function (data) {\n              feature = context.first(data);\n              document = generators.Document.default;\n              document.attributes.name = filesData[0].name;\n              document.attributes.docTitle = filesData[0].name;\n              document.attributes.docType = \"прочее\";\n              document.attributes.docStatus = \"действующий\";\n              document.attributes.pathName = config.documents.documentsUrl + \"/\" + _className + \"/\" + _id + \"/\" + filesData[0].name;\n              document.geometry = null;//carto.getCenter();\n              return db.Document.add(document)\n            })\n            .then(function (data) {\n              return db.Document.getById(data[0][0].objectId)\n            })\n            .then(function (data) {\n              document = context.first(data);\n              var container = {\n                attributes: {\n                  parentMRID:      _id,\n                  chieldMRID:      document.attributes[\"OBJECTID\"],\n                  parentClassName: _className,\n                  chieldClassName: \"Document\"\n                },\n                geometry:   null\n              };\n              return db.DocumentIdentificationObjectRole.add(container);\n            })\n            .then(function () {\n              forms.appendRowInTable(tableName, document.attributes);\n            })\n        })\n    }\n    \n    bindClick(\"edit\" + className + \"Document\", function () {\n      var featureId = forms.getTableSelection(tableName)[\"OBJECTID\"];\n      return db.Document.getById(featureId)\n        .then(function (data) {\n          forms.open(\"Document\", context.first(data));\n        })\n    });\n    \n    bindClick(\"delete\" + className + \"Document\", function () {\n      var features = forms.getTableRows(tableName);\n      var ids = features.map(function (item) {\n        return item.OBJECTID\n      });\n      for (var i = 0; i < ids.length; i++) {\n        db.Document.delById(ids[i]);\n        db.DocumentIdentificationObjectRole\n          .get({where: \"parentClassName='\" + className + \"' AND chieldClassName='Document' AND parentMRID=\" + id + \" AND chieldMRID=\" + ids[i]})\n          .then(function (data) {\n            var keyId = context.key(context.first(data));\n            db.DocumentIdentificationObjectRole.delById(keyId);\n          });\n        forms.deleteRowInTable(tableName, ids[i]);\n      }\n    });\n    \n    db.DocumentIdentificationObjectRole.get({where: \"parentClassName='\" + className + \"' AND chieldClassName='Document' AND parentMRID=\" + id})\n      .then(function (data) {\n        var features = context.all(data);\n        var ids = features.map(function (item) {\n          return item.attributes.chieldMRID\n        });\n        return db.Document.getByArray(ids)\n      })\n      .then(function (data) {\n        forms.createDocumentsTable(tableName, featuresToArray(data), \"Document\");\n      })\n  }\n  \n  async function loadSACEventListChieldClassNameList(id, className, connectionType) {\n    var tableName = \"SACEventList-\" + className + \"-List\";\n    bindClick(\"addSACEventList\" + className, async function () {\n      var editor = _getEditorLayer(className);\n      //noinspection JSUnresolvedFunction\n      var features = editor.getSelectedFeatures();\n      var containers = [];\n      for (var i = 0; i < features.length; i++) {\n        var attributes = features[i].attributes;\n        attributes.parentMRID = id;\n        attributes.chieldMRID = features[i].attributes[\"OBJECTID\"];\n        attributes.parentClassName = \"SACEvent\";\n        attributes.chieldClassName = className;\n        attributes.collectionType = connectionType;\n        delete attributes.OBJECTID;\n        containers.push({\n          attributes: attributes,\n          geometry:   features[i].geometry\n        })\n      }\n      var data = await (db.SACEventList.addArray(containers));\n      var ids = data[0].map(function (item) {\n        return item.objectId\n      });\n      _getEditorLayer(\"SACEventList\").refresh();\n      data = await (db.SACEventList.getByArray(ids));\n      features = context.all(data);\n      features.forEach(function (item) {\n        forms.appendRowInTable(tableName, item.attributes);\n      });\n    });\n    bindClick(\"editSACEventList\" + className, async function () {\n      var featureId = forms.getTableSelection(tableName)[\"OBJECTID\"];\n      var data = await (db.SACEventList.getById(featureId));\n      forms.open(\"SACEventList\", context.first(data));\n      initSACEventListTabs(context.first(data));\n    });\n    bindClick(\"infoSACEventList\" + className, async function () {\n      var feature = forms.getTableSelection(tableName);\n      var data = await (db[feature.chieldClassName].getById(feature.chieldMRID));\n      forms.open(feature.chieldClassName, context.first(data));\n    });\n    bindClick(\"deleteSACEventList\" + className, async function () {\n      var features = forms.getTableRows(tableName);\n      var ids = features.map(function (item) {\n        return item.OBJECTID\n      });\n      await (db.SACEventList.delByArray(ids));\n      forms.removeSelectedRows(tableName);\n      _getEditorLayer(\"SACEventList\").refresh();\n    });\n    \n    var where = \"parentMRID=\" + id + \" AND parentClassName='SACEvent' AND chieldClassName='\" + className + \"'\";\n    var data = await (db.SACEventList.get({where: where}));\n    var features = context.all(data);\n    forms.createTable(tableName, features, \"SACEventList\");\n  }\n  \n  function initSubstationTabs(data) {\n    var id = context.key(data);\n    linkClick(\"Substation-VoltageLevel\", function () {\n      loadSubstationVoltageLevelList(id)\n    });\n    linkClick(\"Substation-PowerTransformer\", function () {\n      loadSubstationPowerTransformerList(id)\n    });\n    linkClick(\"Substation-PowerLine\", function () {\n      loadSubstationPowerLineList(id)\n    });\n    linkClick(\"Substation-MeasurementControl\", function () {\n      loadSubstationMeasurementControlList(id)\n    });\n    linkClick(\"Substation-ErpAddress\", function () {\n      loadSubstationErpAddressList(id)\n    });\n    linkClick(\"Substation-Document\", function () {\n      loadClassNameDocumentList(id, \"Substation\");\n    });\n    linkClick(\"Substation-Geometry\", function () {\n      geometryView.loadGeometryProperty(data, \"Substation-Geometry\")\n    });\n  }\n  \n  async function addSubstation(tableName) {\n    var point = carto.getCenter(map.extent);\n    substation.create(point)\n      .then(function (data) {\n        var feature = context.first(data);\n        forms.appendRowInTable(tableName, feature.attributes);\n        forms.open(\"Substation\", feature);\n        initSubstationTabs(feature);\n      });\n  }\n  \n  function editSubstation(id) {\n    substation.read(id).then(function (data) {\n      forms.open(\"Substation\", context.first(data));\n      initSubstationTabs(context.first(data));\n    })\n  }\n  \n  function deleteSubstation(id, tableName) {\n    substation.del(id)\n      .then(function () {\n        forms.deleteRowInTable(tableName, id);\n      });\n  }\n  \n  async function addPowerLine(tableName) {\n    var data = await (db.PowerLine.add(generators.PowerLine.default));\n    var id = data[0][0].objectId;\n    data = await (db.PowerLine.getById(id));\n    var feature = context.first(data);\n    forms.appendRowInTable(tableName, feature.attributes)\n  }\n  \n  async function editPowerLine(id) {\n    var data = await (db.PowerLine.getById(id));\n    forms.open(\"PowerLine\", context.first(data));\n    console.log(\"Что твм\", context.first(data));\n    loadPowerLineACLineSegmentList(id);\n    //forms.createTable(tableName, acLineSegments, \"ACLineSegment\")\n    linkClick(\"PowerLine-Geometry\", function () {\n      geometryView.loadGeometryProperty(context.first(data), \"PowerLine-Geometry\");\n    });\n    \n  }\n  \n  async function editJoint(id) {\n    var data = await (db.Joint.getById(id));\n    forms.open(\"Joint\", context.first(data));\n    linkClick(\"Joint-Geometry\", function () {\n      geometryView.loadGeometryProperty(context.first(data), \"Joint-Geometry\");\n    });\n  }\n  \n  function deletePowerLine(id, tableName) {\n    db.PowerLine.delById(id);\n    forms.deleteRowInTable(tableName, id);\n  }\n  \n  function loadPowerLineACLineSegmentList(id) {\n    var tableName = \"PowerLine-ACLineSegment-List\";\n    var tableNameSelected = \"PowerLine-ACLineSegment-Select-List\";\n    var kmlBtn = \"ACLineSegment-KML\";\n    forms.createTable(tableName, [], \"ACLineSegment\");\n    updatePowerLineACLineSegment(tableNameSelected);\n    \n    bindClick(\"addPowerLineACLineSegment\", function () {\n      addPowerLineACLineSegment(id, tableName, tableNameSelected);\n    });\n    bindClick(\"editPowerLineACLineSegment\", function () {\n      editACLineSegment(forms.getObjectID(tableName));\n    });\n    bindClick(\"deletePowerLineACLineSegment\", function () {\n      deletePowerLineACLineSegment(id, forms.getObjectID(tableName), tableName);\n    });\n    bindClick(\"updatePowerLineACLineSegment\", function () {\n      updatePowerLineACLineSegment(tableNameSelected);\n    });\n    bindClick(kmlBtn, function () {\n      carto.exportFeaturesToKML(tableName, \"ACLineSegment\");\n    });\n    acLineSegment.allByParent(id).then(function (data) {\n      forms.loadTableData(tableName, featuresToArray(data));\n    });\n  }\n  \n  async function addPowerLineACLineSegment(id, tableNameTo, tableNameFrom) {\n    var _acLineSegment = null;\n    var _acLineSegmentIds = [];\n    var _acLineSegments = [];\n    var _powerLine = null;\n    \n    db.ACLineSegment\n      .getById(forms.getObjectID(tableNameFrom))\n      .then(function (data) {\n        _acLineSegment = context.first(data);\n        var container = context.containerTemplate(id, _acLineSegment.attributes[\"OBJECTID\"],\n          \"PowerLine\", \"ACLineSegment\", carto.getFirstPointInLine(_acLineSegment.geometry));\n        return db.EquipmentContainer.add(container);\n      })\n      .then(function () {\n        return db.EquipmentContainer.get({where: context.containerWhere('PowerLine', 'ACLineSegment', id, null)});\n      })\n      .then(function (data) {\n        _acLineSegmentIds = featuresToArray(data, \"chieldMRID\");\n        return db.ACLineSegment.getByArray(_acLineSegmentIds)\n      })\n      .then(function (data) {\n        _acLineSegments = context.all(data);\n        return db.PowerLine.getById(id)\n      })\n      .then(function (data) {\n        _powerLine = context.first(data);\n        _powerLine.geometry = carto.sumLineGeometry(_acLineSegments);\n        forms.appendRowInTable(tableNameTo, _acLineSegment.attributes);\n        forms.deleteRowInTable(tableNameFrom, _acLineSegment.attributes[\"OBJECTID\"]);\n        return db.PowerLine.set(_powerLine);\n      })\n  }\n  \n  function deletePowerLineACLineSegment(parentId, chieldId, tableName) {\n    var acLineSegmentIds = [];\n    var acLineSegments = [];\n    var powerLine = null;\n    db.EquipmentContainer\n      .get({where: context.containerWhere(\"PowerLine\", \"ACLineSegment\", parentId, null)})\n      .then(function (data) {\n        var ids = featuresToArray(data, \"chieldMRID\");\n        if (ids.length == 1) {\n          alert(\"Не пытайтесь удалить последний сегмент из ЛЭП\");\n          return true;\n        }\n        return db.EquipmentContainer.get({where: \"parentMRID=\" + parentId + \" AND chieldMRID=\" + chieldId + \" AND parentClassName='PowerLine' AND chieldClassName='ACLineSegment'\"})\n      })\n      .then(function (data) {\n        var container = context.first(data);\n        return db.EquipmentContainer.delById(container.attributes[\"OBJECTID\"])\n      })\n      .then(function () {\n        return db.EquipmentContainer\n          .get({where: \"parentMRID=\" + parentId + \" AND parentClassName='PowerLine' AND chieldClassName='ACLineSegment'\"})\n      })\n      .then(function (data) {\n        acLineSegmentIds = featuresToArray(data, \"chieldMRID\");\n        return db.ACLineSegment.getByArray(acLineSegmentIds)\n      })\n      .then(function (data) {\n        acLineSegments = context.all(data);\n        return db.PowerLine.getById(parentId)\n      })\n      .then(function (data) {\n        powerLine = context.first(data);\n        powerLine.geometry = carto.sumLineGeometry(acLineSegments);\n        forms.deleteRowInTable(tableName, chieldId);\n        return db.PowerLine.set(powerLine);\n      })\n      .then(function (data) {\n        console.log(data);\n      });\n  }\n  \n  async function editACLineSegment(id) {\n    var data = await (db.ACLineSegment.getById(id));\n    forms.open(\"ACLineSegment\", context.first(data));\n    initACLineSegmentTabs(context.first(data));\n  }\n  \n  function updatePowerLineACLineSegment(tableName) {\n    //noinspection JSUnresolvedFunction\n    var features = _getEditorLayer(\"ACLineSegment\").getSelectedFeatures();\n    forms.createTable(tableName, features, \"ACLineSegment\");\n  }\n  \n  function initACLineSegmentTabs(data) {\n    var id = context.key(data);\n    linkClick(\"ACLineSegment-Structure\", function () {\n      loadACLineSegmentStructureList(id)\n    });\n    linkClick(\"ACLineSegment-Switch\", function () {\n      loadACLineSegmentSwitchList(id)\n    });\n    linkClick(\"ACLineSegment-Connection-1\", function () {\n      loadACLineSegmentConnectionList(id, 1);\n    });\n    linkClick(\"ACLineSegment-Connection-2\", function () {\n      loadACLineSegmentConnectionList(id, 2);\n    });\n    linkClick(\"ACLineSegment-Document\", function () {\n      loadClassNameDocumentList(id, \"ACLineSegment\")\n    });\n    \n    linkClick(\"ACLineSegment-Geometry\", function () {\n      geometryView.loadGeometryProperty(data, \"ACLineSegment-Geometry\")\n    });\n  }\n  \n  /**\n   * Инициализирует загрузку соединений к ACLineSegment и элементов управления\n   * @param id\n   * @param terminalNumber\n   */\n  async function loadACLineSegmentConnectionList(id, terminalNumber) {\n    var baseTable = \"ACLineSegment-Connection-Current-\" + terminalNumber;\n    var candidateTable = \"ACLineSegment-Connection-Candidate-List-\" + terminalNumber;\n    var candidateColumns = config.misc.ACLineSegment.Connectivity.candidatesTableColumns;\n    \n    bindClick(\"linkConnectionNodeCandidate\" + terminalNumber,\n      async function () {\n        var candidateId = forms.getObjectID(candidateTable);\n        var tableSelection = forms.getTableSelection(candidateTable);\n        var candidateClassName = tableSelection.className;\n        var isGetNominalVoltage = terminalNumber === 1;\n        var candidate = await acLineSegment.connectToCandidate(id, terminalNumber, candidateId, candidateClassName, isGetNominalVoltage);\n        forms.clearTableData(baseTable);\n        forms.createResultTable(baseTable, [candidate], candidateColumns);\n        _getEditorLayer(\"ACLineSegment\").refresh();\n        _getEditorLayer(\"PowerLine\").refresh();\n      });\n    bindClick(\"relinkConnectionNode\" + terminalNumber,\n      async function () {\n        var candidateId = forms.getObjectID(baseTable);\n        var status = await acLineSegment.disconnectFromCandidate(id, terminalNumber, candidateId);\n        if (status) {\n          forms.deleteRowInTable(baseTable, candidateId);\n        }\n      });\n    \n    //возможные соединения\n    var candidates = await loadACLineSegmentCandidateList(id, terminalNumber);\n    forms.createResultTable(candidateTable, candidates, candidateColumns);\n    \n    //текущие соединения\n    var data = await loadACLineSegmentCurrentConnection(id, terminalNumber);\n    if (data.className) forms.createTable(baseTable, context.all(data.data), data.className);\n  }\n  \n  /**\n   * Возвращает имя класса и объекты, соединенные с сегментом / ACLineSegment\n   * @param id\n   * @param terminalNumber\n   * @returns {{data: *, className: (string|null|string|exports.chieldClassName|{alias, group}|string|*)}}\n   */\n  async function loadACLineSegmentCurrentConnection(id, terminalNumber) {\n    var data = await (db.AssetContainer.get({where: \"parentMRID=\" + id + \" AND parentClassName='ACLineSegment' AND localName='terminal\" + terminalNumber + \"'\"}));\n    var feature = context.first(data);\n    if (!feature) return {className: undefined, data: undefined};\n    var chieldClassName = feature.attributes.chieldClassName;\n    data = await (db[chieldClassName].get({where: \"OBJECTID=\" + feature.attributes.chieldMRID}));\n    return {\n      data:      data,\n      className: chieldClassName\n    }\n  }\n  \n  async function loadACLineSegmentCandidateList(id, terminalNumber) {\n    var data = await db.ACLineSegment.getById(id);\n    var feature = context.first(data);\n    var point = terminalNumber === 1 ? carto.getFirstPointInLine(feature.geometry) : carto.getLastPointInLine(feature.geometry);\n    var candidateClasses = [\"VoltageLevel\", \"ACLineSegment\", \"Switch\", \"Joint\"];\n    var candidates = candidateClasses.map(async function (item) {\n      return await (db[item].getByGeometry({where: \"1=1\", geometry: point, distance: 1}));\n    });\n    var result = await Promise.all(candidates);\n    var features = [];\n    for (var i = 0; i < candidateClasses.length; i++) {\n      result[i].features.forEach(function (item) {\n        var candidateColumns = config.misc.ACLineSegment.Connectivity.candidatesTableColumns;\n        var attributes = {className: candidateClasses[i]};\n        candidateColumns.forEach(function (element) {\n          if (element.field != \"className\") attributes[element.field] = item.attributes[element.field];\n        });\n        features.push({attributes: attributes, geometry: item.geometry});\n      })\n    }\n    return features;\n  }\n  \n  function loadACLineSegmentStructureList(id) {\n    var tableNameEquipment = \"ACLineSegment-Structure-List\";\n    var tableNameIntersection = \"ACLineSegment-Structure-Intersects-List\";\n    var btnKML = \"ACLineSegment-Structure-List-KML\";\n    \n    forms.createTable(tableNameEquipment, [], \"Structure\");\n    forms.createTable(tableNameIntersection, [], \"Structure\");\n    \n    bindClick(btnKML, function () {\n      carto.exportFeaturesToKML(tableNameEquipment, \"Structure\");\n    });\n    \n    bindClick(\"editACLineStructure\", function () {\n      editStructure(forms.getObjectID(tableNameEquipment));\n    });\n    bindClick(\"linkACLineSegmentStructure\",\n      function () {\n        var ids = forms.getObjectIDS(tableNameIntersection);\n        for (var i = 0; i < ids.length; i++) {\n          linkACLineSegmentStructure(id, ids[i], tableNameEquipment, tableNameIntersection);\n        }\n      });\n    bindClick(\"relinkACLineSegmentStructure\",\n      function () {\n        var ids = forms.getObjectIDS(tableNameEquipment);\n        for (var i = 0; i < ids.length; i++) {\n          relinkACLineSegmentStructure(id, ids[i], tableNameEquipment, tableNameIntersection);\n        }\n      });\n    \n    var disjoinedStructureList = [];\n    var joinedStructureList = [];\n    var equipmentIds = [];\n    \n    //опоры по EquipmentContainer\n    db.EquipmentContainer\n      .get({\n        where: \"parentMRID = \" + id + \" AND parentClassName = 'ACLineSegment' AND chieldClassName = 'Structure'\"\n      })\n      .then(function (data) {\n        var features = context.all(data);\n        equipmentIds = featuresPropertyToArray(features, \"chieldMRID\");\n        db.Structure\n          .getByArray(equipmentIds)\n          .then(function (data) {\n            joinedStructureList = context.all(data);\n            //forms.createTable(tableNameEquipment, joinedStructureList, \"Structure\");\n            forms.loadTableData(tableNameEquipment, featuresToArray(data));\n          })\n          .always(function () {\n            //опоры по пересечению\n            db.ACLineSegment\n              .getById(id)\n              .then(function (data) {\n                var geometry = context.first(data).geometry;\n                return db.Structure.getByGeometry({where: \"1=1\", geometry: geometry})\n              })\n              .then(function (data) {\n                var intersectStructureList = context.all(data);\n                for (let i = 0; i < intersectStructureList.length; i++) {\n                  intersectStructureList[i][\"JOINED\"] = false;\n                  for (let j = 0; j < joinedStructureList.length; j++) {\n                    if (intersectStructureList[i].attributes[\"OBJECTID\"] == joinedStructureList[j].attributes[\"OBJECTID\"]) {\n                      intersectStructureList[i][\"JOINED\"] = true;\n                    }\n                  }\n                }\n                for (let i = 0; i < intersectStructureList.length; i++) {\n                  if (intersectStructureList[i][\"JOINED\"] == false) {\n                    disjoinedStructureList.push(intersectStructureList[i]);\n                  }\n                }\n                var tableData = {features: disjoinedStructureList};\n                //forms.createTable(tableNameIntersection, tableData, \"Structure\");\n                forms.loadTableData(tableNameIntersection, featuresToArray(tableData));\n              })\n          })\n      });\n  }\n  \n  function linkACLineSegmentStructure(parentId, chieldId, tableNameTo, tableNameFrom) {\n    var chield = null;\n    var container = null;\n    db.Structure.getById(chieldId)\n      .then(function (data) {\n        chield = context.first(data);\n        return acLineSegment.read(parentId);\n      })\n      .then(function () {\n        container = context.containerTemplate(parentId, chieldId, \"ACLineSegment\", \"Structure\", chield.geometry);\n        return db.EquipmentContainer.add(container)\n      })\n      .then(function () {\n        forms.appendRowInTable(tableNameTo, chield.attributes);\n        forms.deleteRowInTable(tableNameFrom, chieldId);\n      })\n  }\n  \n  function relinkACLineSegmentStructure(parentId, chieldId, tableNameTo, tableNameFrom) {\n    db.EquipmentContainer\n      .get({where: \"parentMRID = \" + parentId + \" AND chieldMRID=\" + chieldId + \" AND parentClassName = 'ACLineSegment' AND chieldClassName = 'Structure'\"})\n      .then(function (data) {\n        var id = context.key(context.first(data));\n        db.EquipmentContainer.delById(id);\n        forms.deleteRowInTable(tableNameTo, chieldId);\n        db.Structure\n          .getById(chieldId)\n          .then(function (data) {\n            var feature = context.first(data);\n            forms.appendRowInTable(tableNameFrom, feature.attributes);\n          })\n      })\n  }\n  \n  function loadACLineSegmentSwitchList(id) {\n    var tableNameEquipment = \"ACLineSegment-Switch-List\";\n    var tableNameIntersection = \"ACLineSegment-Switch-Intersects-List\";\n    var switchBtnKML = \"ACLineSegment-Switch-List-KML\";\n    forms.createTable(tableNameEquipment, [], \"Switch\");\n    forms.createTable(tableNameIntersection, [], \"Switch\");\n    \n    bindClick(switchBtnKML, function () {\n      carto.exportFeaturesToKML(tableNameEquipment, \"Switch\");\n    });\n    \n    bindClick(\"editACLineSwitch\", function () {\n      editSwitch(forms.getObjectID(tableNameEquipment));\n    });\n    bindClick(\"linkACLineSegmentSwitch\",\n      function () {\n        linkACLineSegmentSwitch(id, forms.getObjectID(tableNameIntersection), tableNameEquipment, tableNameIntersection);\n      });\n    bindClick(\"relinkACLineSegmentSwitch\", function () {\n      relinkACLineSegmentSwitch(id, forms.getObjectID(tableNameEquipment), tableNameEquipment, tableNameIntersection);\n    });\n    \n    var disjoinedSwitchList = [];\n    var joinedSwitchList = [];\n    var equipmentIds = [];\n    \n    //опоры по EquipmentContainer\n    db.EquipmentContainer\n      .get({\n        where: \"parentMRID = \" + id + \" AND parentClassName = 'ACLineSegment' AND chieldClassName = 'Switch'\"\n      })\n      .then(function (data) {\n        var features = context.all(data);\n        equipmentIds = featuresPropertyToArray(features, \"chieldMRID\");\n        db.Switch\n          .getByArray(equipmentIds)\n          .then(function (data) {\n            joinedSwitchList = context.all(data);\n            forms.loadTableData(tableNameEquipment, featuresToArray(data));\n          })\n          .always(function () {\n            //опоры по пересечению\n            db.ACLineSegment\n              .getById(id)\n              .then(function (data) {\n                var geometry = context.first(data).geometry;\n                return db.Switch.getByGeometry({where: \"1=1\", geometry: geometry})\n              })\n              .then(function (data) {\n                var intersectSwitchList = context.all(data);\n                for (let i = 0; i < intersectSwitchList.length; i++) {\n                  intersectSwitchList[i][\"JOINED\"] = false;\n                  for (let j = 0; j < joinedSwitchList.length; j++) {\n                    if (intersectSwitchList[i].attributes[\"OBJECTID\"] == joinedSwitchList[j].attributes[\"OBJECTID\"]) {\n                      intersectSwitchList[i][\"JOINED\"] = true;\n                    }\n                  }\n                }\n                for (let i = 0; i < intersectSwitchList.length; i++) {\n                  if (intersectSwitchList[i][\"JOINED\"] == false) {\n                    disjoinedSwitchList.push(intersectSwitchList[i]);\n                  }\n                }\n                var tableData = {features: disjoinedSwitchList};\n                forms.loadTableData(tableNameIntersection, featuresToArray(tableData));\n              })\n          })\n      });\n  }\n  \n  async function linkACLineSegmentSwitch(parentId, chieldId, tableNameTo, tableNameFrom) {\n    var data = await (db.Switch.getById(chieldId));\n    var chield = context.first(data);\n    var container = generators.EquipmentContainer.default;\n    container.geometry = chield.geometry;\n    container.attributes.parentClassName = \"ACLineSegment\";\n    container.attributes.chieldClassName = \"Switch\";\n    container.attributes.parentMRID = parentId;\n    container.attributes.chieldMRID = chieldId;\n    var action = await (db.EquipmentContainer.add(container));\n    if (action) {\n      forms.appendRowInTable(tableNameTo, chield.attributes);\n      forms.deleteRowInTable(tableNameFrom, chieldId);\n    }\n  }\n  \n  function relinkACLineSegmentSwitch(parentId, chieldId, tableNameTo, tableNameFrom) {\n    db.EquipmentContainer\n      .get({where: \"parentMRID = \" + parentId + \" AND chieldMRID=\" + chieldId + \" AND parentClassName = 'ACLineSegment' AND chieldClassName = 'Switch'\"})\n      .then(function (data) {\n        var id = context.key(context.first(data));\n        db.EquipmentContainer.delById(id);\n        forms.deleteRowInTable(tableNameTo, chieldId);\n        db.Switch\n          .getById(chieldId)\n          .then(function (data) {\n            var feature = context.first(data);\n            forms.appendRowInTable(tableNameFrom, feature.attributes);\n          })\n      })\n  }\n  \n  async function editStructure(id) {\n    var data = await (db.Structure.getById(id));\n    forms.open(\"Structure\", context.first(data));\n  }\n  \n  async function editSwitch(id) {\n    var data = await (db.Switch.getById(id));\n    forms.open(\"Switch\", context.first(data));\n  }\n  \n  function loadSubstationVoltageLevelList(id) {\n    var tableName = \"Substation-VoltageLevel-List\";\n    forms.createTable(tableName, [], \"VoltageLevel\");\n    \n    bindClick(\"addVoltageLevel\", function () {\n      createVoltageLevel(id, tableName);\n    });\n    bindClick('editVoltageLevel', function () {\n      editVoltageLevel(forms.getObjectID(tableName));\n    });\n    bindClick('deleteVoltageLevel', function () {\n      deleteVoltageLevel(forms.getObjectID(tableName), tableName);\n    });\n    \n    db.EquipmentContainer\n      .get({\n        where: \"parentMRID = \" + id + \" AND parentClassName = 'Substation' AND chieldClassName = 'VoltageLevel'\"\n      })\n      .then(function (data) {\n        var features = context.all(data);\n        var ids = featuresPropertyToArray(features, \"chieldMRID\");\n        db.VoltageLevel\n          .getByArray(ids)\n          .then(function (data) {\n            forms.loadTableData(tableName, featuresToArray(data));\n          })\n      });\n  }\n  \n  async function createVoltageLevel(id, tableName) {\n    var data = await (voltageLevel.create(id));\n    forms.appendRowInTable(tableName, context.first(data).attributes);\n  }\n  \n  async function editVoltageLevel(id) {\n    var data = await (voltageLevel.read(id));\n    forms.open(\"VoltageLevel\", context.first(data));\n  }\n  \n  async function deleteVoltageLevel(id, tableName) {\n    var action = await (voltageLevel.del(id));\n    forms.deleteRowInTable(tableName, id);\n    return action;\n  }\n  \n  async function loadSubstationErpAddressList(id) {\n    var tableName = \"Substation-ErpAddress-List\";\n    forms.createTable(tableName, [], \"ErpAddress\");\n    \n    bindClick(\"addSubstationErpAddress\", function () {\n      createErpAddress(id, tableName);\n    });\n    bindClick('editSubstationErpAddress', function () {\n      editErpAddress(forms.getObjectID(tableName));\n    });\n    bindClick('deleteSubstationErpAddress', function () {\n      deleteErpAddress(forms.getObjectID(tableName));\n    });\n    \n    var data = await (db.Location.get({where: \"parentMRID = \" + id + \" AND parentClassName = 'Substation' AND chieldClassName = 'ErpAddress'\"}));\n    var features = context.all(data);\n    var ids = featuresPropertyToArray(features, \"chieldMRID\");\n    data = await (db.ErpAddress.getByArray(ids));\n    forms.loadTableData(tableName, featuresToArray(data));\n  }\n  \n  function createErpAddress(id, tableName) {\n    var substation = {};\n    db.Substation\n      .getById(id)\n      .then(function (data) {\n        substation = context.first(data);\n        var graphic = {geometry: substation.geometry, attributes: generators.ErpAddress.default};\n        db.ErpAddress\n          .add(graphic)\n          .then(function (data) {\n            return db.ErpAddress.getByData(data);\n          })\n          .then(function (data) {\n            var feature = context.first(data);\n            forms.appendRowInTable(tableName, feature.attributes);\n            \n            var location = graphic;\n            location.attributes.parentMRID = id;\n            location.attributes.chieldMRID = feature.attributes[\"OBJECTID\"];\n            location.attributes.parentClassName = \"Substation\";\n            location.attributes.chieldClassName = \"ErpAddress\";\n            db.Location\n              .add(location)\n              .then(function (data) {\n              });\n          });\n      })\n  }\n  \n  async function editErpAddress(id) {\n    var data = await (db.ErpAddress.getById(id));\n    forms.open(\"ErpAddress\", context.first(data));\n  }\n  \n  function deleteErpAddress(id) {\n    db.Location\n      .get({where: \"chieldMRID = \" + id + \" AND chieldClassName='ErpAddress' AND parentClassName='Substation'\"})\n      .then(function (data) {\n        return db.Location.delById(context.key(context.first(data)))\n      })\n      .then(function () {\n        return db.ErpAddress.delById(id)\n      })\n      .then(function () {\n        forms.deleteRowInTable(\"Substation-ErpAddress-List\", id)\n      })\n  }\n  \n  function loadSubstationPowerTransformerList(id) {\n    var tableName = \"Substation-PowerTransformer-List\";\n    \n    forms.createTable(tableName, [], \"PowerTransformer\");\n    \n    bindClick(\"addPowerTransformer\", function () {\n      createPowerTransformer(id, tableName);\n    });\n    bindClick('editPowerTransformer', function () {\n      editPowerTransformer(forms.getObjectID(tableName));\n    });\n    bindClick('deletePowerTransformer', function () {\n      deletePowerTransformer(forms.getObjectID(tableName), tableName);\n    });\n    \n    db.EquipmentContainer\n      .get({\n        where: \"parentMRID = \" + id + \" AND parentClassName = 'Substation' AND chieldClassName = 'PowerTransformer'\"\n      })\n      .then(function (data) {\n        var features = context.all(data);\n        var ids = featuresPropertyToArray(features, \"chieldMRID\");\n        db.PowerTransformer\n          .getByArray(ids)\n          .then(function (data) {\n            forms.loadTableData(tableName, featuresToArray(data));\n          })\n      });\n  }\n  \n  function createPowerTransformer(id, tableName) {\n    powerTransformer.create(id).then(function (data) {\n      forms.appendRowInTable(tableName, context.first(data).attributes);\n    });\n  }\n  \n  function editPowerTransformer(id) {\n    powerTransformer.read(id)\n      .then(function (data) {\n        var feature = context.first(data);\n        forms.open(\"PowerTransformer\", feature);\n        loadPowerTransformerMeasurementControlList(context.key(feature));\n      });\n  }\n  \n  function deletePowerTransformer(id, tableName) {\n    powerTransformer.del(id).then(function () {\n      forms.deleteRowInTable(tableName, id)\n    });\n  }\n  \n  function loadSubstationPowerLineList(id) {\n    var tableName = \"Substation-PowerLine-List\";\n    return db.EquipmentContainer.get({where: \"parentClassName='Substation' AND chieldClassName='VoltageLevel' AND parentMRID=\" + id})\n      .then(function (data) {\n        var features = context.all(data);\n        var ids = features.map(function (item) {\n          return item.attributes.chieldMRID\n        });\n        ids = \"chieldMRID=\" + ids.join(\" OR chieldMRID=\");\n        return db.AssetContainer.get({where: \"parentClassName='ACLineSegment' AND chieldClassName='VoltageLevel' AND \" + ids})\n      })\n      .then(function (data) {\n        var features = context.all(data);\n        var ids = features.map(function (item) {\n          return item.attributes.parentMRID\n        });\n        ids = \"chieldMRID=\" + ids.join(\" OR chieldMRID=\");\n        return db.EquipmentContainer.get({where: \"parentClassName='PowerLine' AND chieldClassName='ACLineSegment' AND \" + ids})\n      })\n      .then(function (data) {\n        var features = context.all(data);\n        var ids = features.map(function (item) {\n          return item.attributes.parentMRID\n        });\n        ids = \"OBJECTID=\" + ids.join(\" OR OBJECTID=\");\n        return db.PowerLine.get({where: ids});\n      })\n      .then(function (data) {\n        forms.createTable(tableName, data.features, \"PowerLine\");\n      })\n  }\n  \n  function loadSubstationMeasurementControlList(id) {\n    var tableName = \"Substation-MeasurementControl-List\";\n    forms.createTable(\"Substation-MeasurementControl-List\", [], \"SubstationMeasurementControl\");\n    \n    bindClick(\"addSubstationMeasurementControl\", function () {\n      createSubstationMeasurementControl(id, tableName);\n    });\n    bindClick('editSubstationMeasurementControl', function () {\n      editSubstationMeasurementControl(forms.getObjectID(tableName));\n    });\n    bindClick('deleteSubstationMeasurementControl', function () {\n      deleteSubstationMeasurementControl(forms.getObjectID(tableName));\n    });\n    \n    db.MeasurementContainer\n      .get({\n        where: \"parentMRID = \" + id + \" AND parentClassName = 'Substation' AND chieldClassName = 'SubstationMeasurementControl'\"\n      })\n      .then(function (data) {\n        var features = context.all(data);\n        var ids = featuresPropertyToArray(features, \"chieldMRID\");\n        db.SubstationMeasurementControl\n          .getByArray(ids)\n          .then(function (data) {\n            forms.loadTableData(\"Substation-MeasurementControl-List\", featuresToArray(data));\n          })\n      });\n  }\n  \n  function createSubstationMeasurementControl(id, tableName) {\n    var substation = {};\n    db.Substation\n      .getById(id)\n      .then(function (data) {\n        substation = context.first(data);\n        var graphic = {\n          geometry:   substation.geometry,\n          attributes: generators.SubstationMeasurementControl.default\n        };\n        db.SubstationMeasurementControl\n          .add(graphic)\n          .then(function (data) {\n            return db.SubstationMeasurementControl.getByData(data);\n          })\n          .then(function (data) {\n            var feature = context.first(data);\n            forms.appendRowInTable(tableName, feature.attributes);\n            \n            var equipment = graphic;\n            equipment.attributes.parentMRID = id;\n            equipment.attributes.chieldMRID = feature.attributes[\"OBJECTID\"];\n            equipment.attributes.parentClassName = \"Substation\";\n            equipment.attributes.chieldClassName = \"SubstationMeasurementControl\";\n            db.MeasurementContainer\n              .add(equipment)\n              .then(function (data) {\n              });\n          });\n      })\n  }\n  \n  function editSubstationMeasurementControl(id) {\n    db.SubstationMeasurementControl\n      .getById(id)\n      .then(function (data) {\n        var feature = context.first(data);\n        forms.open(\"SubstationMeasurementControl\", feature);\n      });\n  }\n  \n  function deleteSubstationMeasurementControl(id) {\n    db.MeasurementContainer\n      .get({where: \"chieldMRID = \" + id + \" AND chieldClassName='SubstationMeasurementControl' AND parentClassName='Substation'\"})\n      .then(function (data) {\n        return db.MeasurementContainer.delById(context.key(context.first(data)))\n      })\n      .then(db.SubstationMeasurementControl.delById(id))\n      .then(function () {\n        forms.deleteRowInTable(\"Substation-MeasurementControl-List\", id)\n      })\n  }\n  \n  function loadPowerTransformerMeasurementControlList(id) {\n    var tableName = \"PowerTransformer-MeasurementControl-List\";\n    forms.createTable(tableName, [], \"PowerTransformerMeasurementControl\");\n    \n    bindClick(\"addPowerTransformerMeasurementControl\", function () {\n      createPowerTransformerMeasurementControl(id, tableName);\n    });\n    bindClick('editPowerTransformerMeasurementControl', function () {\n      editPowerTransformerMeasurementControl(forms.getObjectID(tableName));\n    });\n    bindClick('deletePowerTransformerMeasurementControl', function () {\n      deletePowerTransformerMeasurementControl(forms.getObjectID(tableName));\n    });\n    \n    db.MeasurementContainer\n      .get({\n        where: \"parentMRID = \" + id + \" AND parentClassName = 'PowerTransformer' AND chieldClassName = 'PowerTransformerMeasurementControl'\"\n      })\n      .then(function (data) {\n        var features = context.all(data);\n        var ids = featuresPropertyToArray(features, \"chieldMRID\");\n        db.PowerTransformerMeasurementControl\n          .getByArray(ids)\n          .then(function (data) {\n            forms.loadTableData(tableName, featuresToArray(data));\n          })\n      });\n  }\n  \n  function createPowerTransformerMeasurementControl(id, tableName) {\n    var PowerTransformer = {};\n    db.PowerTransformer\n      .getById(id)\n      .then(function (data) {\n        PowerTransformer = context.first(data);\n        var graphic = {\n          geometry:   PowerTransformer.geometry,\n          attributes: generators.PowerTransformerMeasurementControl.default\n        };\n        db.PowerTransformerMeasurementControl\n          .add(graphic)\n          .then(function (data) {\n            return db.PowerTransformerMeasurementControl.getByData(data);\n          })\n          .then(function (data) {\n            var feature = context.first(data);\n            forms.appendRowInTable(tableName, feature.attributes);\n            \n            var equipment = graphic;\n            equipment.attributes.parentMRID = id;\n            equipment.attributes.chieldMRID = feature.attributes[\"OBJECTID\"];\n            equipment.attributes.parentClassName = \"PowerTransformer\";\n            equipment.attributes.chieldClassName = \"PowerTransformerMeasurementControl\";\n            db.MeasurementContainer\n              .add(equipment)\n              .then(function (data) {\n              });\n          });\n      })\n  }\n  \n  function editPowerTransformerMeasurementControl(id) {\n    db.PowerTransformerMeasurementControl\n      .getById(id)\n      .then(function (data) {\n        var feature = context.first(data);\n        forms.open(\"PowerTransformerMeasurementControl\", feature);\n      });\n  }\n  \n  function deletePowerTransformerMeasurementControl(id) {\n    db.MeasurementContainer\n      .get({where: \"chieldMRID = \" + id + \" AND chieldClassName='PowerTransformerMeasurementControl' AND parentClassName='PowerTransformer'\"})\n      .then(function (data) {\n        return db.MeasurementContainer.delById(context.key(context.first(data)))\n      })\n      .then(db.PowerTransformerMeasurementControl.delById(id))\n      .then(function () {\n        forms.deleteRowInTable(\"PowerTransformer-MeasurementControl-List\", id)\n      })\n  }\n  \n  function pointToFeature(className, point) {\n    var feature = generators[className][\"defaultType1\"];\n    feature.geometry = point;\n    switch (className) {\n      case \"Substation\":\n        return db.Substation\n          .add(feature)\n          .then(function (data) {\n            var id = data[0][0].objectId;\n            return substation.createDefaultEquipment(id);\n          });\n        break;\n      case \"Structure\":\n        return db[className].add(feature);\n        break;\n      case \"Switch\":\n        return db[className].add(feature);\n        break;\n    }\n    \n  }\n  \n  function readGPXFile(evt) {\n    var tableName = \"gpx-table\";\n    //Retrieve the first (and only!) File from the FileList object\n    bindClick(\"deleteGpxPoints\", function () {\n      carto.deleteGpxPoints();\n      forms.loadTableData(tableName, null);\n    });\n    \n    bindClick(\"pointToStructure\", function () {\n      var data = forms.getTableSelection(tableName);\n      var feature = generators.Structure.defaultType1;\n      feature.attributes.localName = data.name;\n      feature.attributes.description = data.desc;\n      feature.geometry = carto.toMercator(data.lon, data.lat);\n      db.Structure\n        .add(feature)\n        .then(function () {\n          forms.removeSelectedRow(tableName);\n          _getEditorLayer(\"Structure\").refresh();\n        })\n    });\n    \n    bindClick(\"pointToSwitch\", function () {\n      var data = forms.getTableSelection(tableName);\n      var feature = generators.Switch.defaultType1;\n      feature.attributes.localName = data.name;\n      feature.attributes.description = data.desc;\n      feature.geometry = carto.toMercator(data.lon, data.lat);\n      db.Switch\n        .add(feature)\n        .then(function () {\n          forms.removeSelectedRow(tableName);\n          _getEditorLayer(\"Switch\").refresh();\n        })\n    });\n    \n    bindClick(\"pointToSubstation\", function () {\n      var data = forms.getTableSelection(tableName);\n      var feature = generators.Substation.defaultType1;\n      feature.attributes.localName = data.name;\n      feature.attributes.description = data.desc;\n      feature.geometry = carto.toMercator(data.lon, data.lat);\n      db.Substation\n        .add(feature)\n        .then(function (data) {\n          var id = data[0][0].objectId;\n          return substation.createDefaultEquipment(id);\n        })\n        .then(function () {\n          forms.removeSelectedRow(tableName);\n          _getEditorLayer(\"Substation\").refresh();\n        });\n    });\n    \n    bindClick(\"pointsToPowerLine\", function () {\n      var data = forms.getTableRows(tableName);\n      var features = [];\n      var points = [];\n      for (var i = 0; i < data.length; i++) {\n        var feature = {\n          geometry:   carto.toMercator(data[i].lon, data[i].lat),\n          attributes: {\n            localName:   data[i].name,\n            description: data[i].description\n          }\n        };\n        features.push(feature);\n        points.push(feature.geometry);\n      }\n      var lineGeometry = carto.pointsToPolyline(points);\n      var _structures = null;\n      var _acLineSegment = null;\n      var _powerLine = null;\n      return db.Structure\n        .addArray(features)\n        .then(function (data) {\n          var ids = data[0].map(function (item) {\n            return item.objectId;\n          });\n          forms.removeSelectedRows(tableName);\n          _getEditorLayer(\"Structure\").refresh();\n          return db.Structure.getByArray(ids);\n        })\n        .then(function (data) {\n          _structures = context.all(data);\n          return acLineSegment.createDefault(lineGeometry);\n        })\n        .then(function (data) {\n          var id = context.getAdds(data)[0].objectId;\n          _getEditorLayer(\"ACLineSegment\").refresh();\n          return acLineSegment.read(id);\n        })\n        .then(function (data) {\n          _acLineSegment = context.first(data);\n          return temporaryPowerLine.create(lineGeometry);\n        })\n        .then(function (data) {\n          _getEditorLayer(\"PowerLine\").refresh();\n          _powerLine = context.first(data);\n          var containers = [];\n          for (var i = 0; i < _structures.length; i++) {\n            var item = context.containerTemplate(context.key(_acLineSegment), context.key(_structures[i]),\n              \"ACLineSegment\", \"Structure\", _structures[i].geometry);\n            containers.push(item);\n          }\n          return db.EquipmentContainer.addArray(containers);\n        })\n        .then(function () {\n          var container = context.containerTemplate(context.key(_powerLine), context.key(_acLineSegment),\n            \"PowerLine\", \"ACLineSegment\", carto.getFirstPointInLine(lineGeometry));\n          return db.EquipmentContainer.add(container);\n        })\n      \n    });\n    \n    var files = evt.target.files[0];\n    \n    if (files) {\n      var fileReader = new FileReader();\n      var fileType = files.type;\n      fileReader.readAsText(files);\n      fileReader.onload = function (e) {\n        var contents = e.target.result;\n        var dom = (new DOMParser()).parseFromString(contents, 'text/xml');\n        var geoJson = null;\n        if (fileType == 'application/vnd.google-earth.kml+xml') {\n          geoJson = toGeoJSON.kml(dom);\n        }\n        else {\n          geoJson = toGeoJSON.gpx(dom);\n        }\n        \n        var features = carto.parseGeoJSON(geoJson);\n        var data = featuresToArray({features: features});\n        forms.loadTableData(\"gpx-table\", data);\n        carto.addGpxGraphicsToMap(features);\n      }\n    } else {\n      alert(\"Не получилось загрузить файл gpx\");\n    }\n  }\n  \n  function openAccountsManageSettings() {\n    var tableName = \"accounts-manage-container\";\n    forms.showWindow(\"accounts-window\");\n    \n    bindClick(\"addAccount\", function () {\n      createAccount(tableName);\n    });\n    bindClick(\"editAccount\", function () {\n      editAccount(forms.getObjectID(tableName), tableName);\n    });\n    bindClick(\"deleteAccount\", function () {\n      deleteAccount(forms.getObjectID(tableName), tableName);\n    });\n    \n    account.all()\n      .then(function (data) {\n        forms.createTable(tableName, context.all(data), \"Account\", null);\n        forms.hideColumn(tableName, \"password\");\n        forms.hideColumn(tableName, \"lat\");\n        forms.hideColumn(tableName, \"lon\");\n        forms.hideColumn(tableName, \"createDate\");\n      })\n  }\n  \n  function createAccount(tableName) {\n    account.create(carto.getCenter(map.extent))\n      .then(function (data) {\n        var feature = context.first(data);\n        forms.appendRowInTable(tableName, feature.attributes);\n        forms.open(\"Account\", feature);\n      });\n  }\n  \n  function editAccount(id) {\n    account.read(id).then(function (data) {\n      forms.open(\"Account\", context.first(data));\n    });\n  }\n  \n  function deleteAccount(id, tableName) {\n    account.del(id).then(function () {\n      forms.deleteRowInTable(tableName, id);\n    });\n  }\n  \n  function openAccountSettings(account) {\n    db.Account\n      .getById(context.key(account))\n      .then(function (data) {\n        forms.open(\"Account\", context.first(data));\n      })\n  }\n  \n  function openSessionManageWindow() {\n    var tableName = \"sessionManageDiv\";\n    var schedulerName = \"sessionSchedulerDiv\";\n    forms.showWindow(\"session-container\");\n    db.Session.get({where: \"1=1\"}).then(function (data) {\n      var sessions = context.all(data);\n      forms.createTable(tableName, sessions, \"Session\");\n      forms.createScheduler(schedulerName, sessions);\n    })\n  }\n  \n  return {\n    getClickHandler:                 getClickHandler,\n    getEditorHandler:                getEditorHandler,\n    updateTechnicalConnectionInfo:   interactiveMap.updateTechnicalConnectionInfo,\n    getSubstationEnergyCenterReport: interactiveMap.getSubstationEnergyCenterReport,\n    loadPowerLineList:               loadPowerLineList,\n    loadSubstationList:              loadSubstationList,\n    openAccountSettings:             openAccountSettings,\n    openAccountsManageSettings:      openAccountsManageSettings,\n    openSessionManageWindow:         openSessionManageWindow,\n    pointToFeature:                  pointToFeature,\n    exportMap:                       exportUtils.exportMap,\n    showSituationCenterMessages:     sac.showSituationCenterMessages,\n    showNetworkProjects:             projects.showNetworkProjects,\n    loadNetworkProject:              dxfUtils.loadNetworkProject,\n    initFeatureList:                 initFeatureList,\n    readGPXFile:                     readGPXFile\n  }\n});"]}